{{define "main"}}
<div style="display:flex;flex-direction:column;gap:1em;">

  <div class="nes-container is-dark">
    <h1>Friends</h1>
  </div>

  <div id="friendList"
       hx-get="/u"
       hx-swap="outerHTML"
       hx-select="#friendList"
       hx-trigger="USER_UPDATE from:body">
    {{range .AllUsers}}
    <a href="/u/{{.ID}}/chat">
      <div class="nes-container ghost" style="display:flex; gap:1em">
        <img src="{{.AvatarURL}}">
        <div style="display:flex;flex-direction:column">
          <h2>
            {{.Username}} ({{.Role}})
          </h2>
          {{if (eq .Count 1)}}
          <p class="nes-text is-error">{{.Count}} unread message</p>
          {{end}}
          {{if (gt .Count 1)}}
          <p class="nes-text is-error">{{.Count}} unread messages</p>
          {{end}}
        </div>
      </div>
    </a>
    {{end}}
  </div>
</div>
{{end}}
